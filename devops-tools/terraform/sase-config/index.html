<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terraform SASE Bootstrapper</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-hcl.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00d4ff;
            --secondary: #7928ca;
            --accent: #ff0080;
            --bg-dark: #000000;
            --bg-darker: #0a0a0a;
            --bg-card: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --border: #2a2a2a;
            --success: #00ff88;
            --warning: #ffaa00;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            overflow: hidden;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(circle at 20% 50%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(121, 40, 202, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 20%, rgba(255, 0, 128, 0.1) 0%, transparent 50%);
            animation: bgPulse 15s ease-in-out infinite;
        }

        @keyframes bgPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .app-wrapper {
            position: relative;
            z-index: 1;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
        }

        .logo-text h1 {
            font-size: 1.8em;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        /* Wizard Container */
        .wizard-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        /* Step Navigator */
        .step-navigator {
            width: 280px;
            background: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(10px);
            border-right: 1px solid var(--border);
            padding: 30px 20px;
            overflow-y: auto;
        }

        .step-item {
            padding: 20px;
            margin-bottom: 12px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .step-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .step-item:hover {
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .step-item.active {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(121, 40, 202, 0.1));
            border-color: var(--primary);
        }

        .step-item.active::before {
            opacity: 1;
        }

        .step-item.completed {
            border-color: var(--success);
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--border);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 0.9em;
        }

        .step-item.active .step-number {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }

        .step-item.completed .step-number {
            background: var(--success);
        }

        .step-item.completed .step-number::after {
            content: '‚úì';
        }

        .step-title {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.95em;
        }

        .step-desc {
            font-size: 0.8em;
            color: var(--text-secondary);
        }

        /* Content Area */
        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-header {
            padding: 30px 40px;
            background: rgba(26, 26, 26, 0.6);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
        }

        .content-header h2 {
            font-size: 2em;
            margin-bottom: 8px;
            background: linear-gradient(90deg, var(--text-primary), var(--text-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .content-header p {
            color: var(--text-secondary);
            font-size: 1em;
        }

        .content-body {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }

        /* Step Content */
        .step-content {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .step-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Vendor Cards */
        .vendor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .vendor-card {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .vendor-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .vendor-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.2);
        }

        .vendor-card.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(121, 40, 202, 0.1));
            box-shadow: 0 0 40px rgba(0, 212, 255, 0.3);
        }

        .vendor-card.selected::before {
            opacity: 0.05;
        }

        .vendor-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin-bottom: 16px;
        }

        .vendor-card.selected .vendor-icon {
            animation: iconPulse 2s ease-in-out infinite;
        }

        @keyframes iconPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .vendor-name {
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .vendor-desc {
            color: var(--text-secondary);
            font-size: 0.9em;
            line-height: 1.5;
        }

        .vendor-badge {
            display: inline-block;
            padding: 6px 12px;
            background: rgba(0, 255, 136, 0.1);
            color: var(--success);
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
            margin-top: 12px;
        }

        /* Form Elements */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 30px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: 600;
            font-size: 0.9em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 14px 16px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1em;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(0, 212, 255, 0.1);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
            font-family: 'Monaco', 'Courier New', monospace;
        }

        /* Advanced Config */
        .config-section {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .config-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .config-section-title {
            font-size: 1.2em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toggle-switch {
            position: relative;
            width: 52px;
            height: 28px;
            background: var(--border);
            border-radius: 14px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        .toggle-switch.active::after {
            transform: translateX(24px);
        }

        /* Tunnel Config */
        .tunnel-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .tunnel-item {
            background: rgba(0, 212, 255, 0.05);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            position: relative;
        }

        .tunnel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .tunnel-title {
            font-weight: 600;
            font-size: 1.1em;
        }

        .tunnel-badge {
            padding: 6px 12px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        /* Buttons */
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.6);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
        }

        .btn-success {
            background: linear-gradient(135deg, #00ff88, #00d4ff);
            color: var(--bg-dark);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: var(--bg-dark);
        }

        .btn-icon {
            width: 44px;
            height: 44px;
            padding: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            padding: 30px 40px;
            background: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--border);
        }

        /* Code Preview Modal */
        .code-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .code-modal.show {
            display: flex;
        }

        .code-modal-content {
            background: var(--bg-darker);
            border: 2px solid var(--border);
            border-radius: 20px;
            width: 90%;
            max-width: 1200px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 212, 255, 0.3);
        }

        .code-modal-header {
            padding: 24px 30px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .code-modal-title {
            font-size: 1.5em;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .code-modal-tabs {
            display: flex;
            gap: 8px;
            padding: 0 30px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
        }

        .code-modal-tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 600;
        }

        .code-modal-tab:hover {
            color: var(--text-primary);
        }

        .code-modal-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .code-modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }

        pre {
            margin: 0 !important;
            border-radius: 12px !important;
        }

        /* Summary View */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .summary-card {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 24px;
        }

        .summary-card-header {
            font-weight: 600;
            font-size: 0.9em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .summary-value {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .summary-detail {
            font-size: 0.9em;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* List Items */
        .list-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(0, 212, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .list-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1em;
        }

        /* Progress Bar */
        .progress-bar {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.5s;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-darker);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .wizard-container {
                flex-direction: column;
            }

            .step-navigator {
                width: 100%;
                max-height: 200px;
                overflow-x: auto;
                overflow-y: hidden;
                display: flex;
                gap: 12px;
                padding: 20px;
            }

            .step-item {
                min-width: 200px;
                margin-bottom: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <div class="app-wrapper">
        <!-- Header -->
        <div class="header">
            <div class="logo-section">
                <div class="logo-icon">üåê</div>
                <div class="logo-text">
                    <h1>SASE Bootstrapper</h1>
                    <p>Zero-Touch SASE Deployment Automation</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-outline" onclick="resetWizard()">‚Üª Reset</button>
                <button class="btn btn-secondary" onclick="saveProgress()">üíæ Save Progress</button>
            </div>
        </div>

        <!-- Wizard Container -->
        <div class="wizard-container">
            <!-- Step Navigator -->
            <div class="step-navigator">
                <div class="step-item active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-title">Vendor Selection</div>
                    <div class="step-desc">Choose your SASE platform</div>
                </div>
                <div class="step-item" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-title">Site Configuration</div>
                    <div class="step-desc">Define your locations</div>
                </div>
                <div class="step-item" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-title">Tunnel Setup</div>
                    <div class="step-desc">IPsec & connectivity</div>
                </div>
                <div class="step-item" data-step="4">
                    <div class="step-number">4</div>
                    <div class="step-title">Routing & BGP</div>
                    <div class="step-desc">Dynamic routing config</div>
                </div>
                <div class="step-item" data-step="5">
                    <div class="step-number">5</div>
                    <div class="step-title">Security Policies</div>
                    <div class="step-desc">Firewall & access rules</div>
                </div>
                <div class="step-item" data-step="6">
                    <div class="step-number">6</div>
                    <div class="step-title">Review & Generate</div>
                    <div class="step-desc">Final configuration</div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <div class="content-header">
                    <h2 id="step-title">Select Your SASE Vendor</h2>
                    <p id="step-description">Choose the SASE platform you want to deploy and configure</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                </div>

                <div class="content-body">
                    <!-- Step 1: Vendor Selection -->
                    <div class="step-content active" data-step="1">
                        <div class="vendor-grid">
                            <div class="vendor-card" data-vendor="prisma">
                                <div class="vendor-icon">üîí</div>
                                <div class="vendor-name">Prisma Access</div>
                                <div class="vendor-desc">Palo Alto Networks cloud-delivered security platform with GlobalProtect integration</div>
                                <span class="vendor-badge">Most Popular</span>
                            </div>
                            <div class="vendor-card" data-vendor="zscaler">
                                <div class="vendor-icon">‚òÅÔ∏è</div>
                                <div class="vendor-name">Zscaler</div>
                                <div class="vendor-desc">Zero Trust Exchange with ZIA (Internet Access) and ZPA (Private Access)</div>
                                <span class="vendor-badge">Cloud-Native</span>
                            </div>
                            <div class="vendor-card" data-vendor="fortinet">
                                <div class="vendor-icon">üõ°Ô∏è</div>
                                <div class="vendor-name">Fortinet SASE</div>
                                <div class="vendor-desc">FortiSASE with SD-WAN, ZTNA, and Secure Web Gateway</div>
                                <span class="vendor-badge">Integrated</span>
                            </div>
                            <div class="vendor-card" data-vendor="cisco">
                                <div class="vendor-icon">üåê</div>
                                <div class="vendor-name">Cisco SD-WAN</div>
                                <div class="vendor-desc">Viptela-based SD-WAN with Umbrella and Secure Firewall integration</div>
                                <span class="vendor-badge">Enterprise</span>
                            </div>
                            <div class="vendor-card" data-vendor="versa">
                                <div class="vendor-icon">‚ö°</div>
                                <div class="vendor-name">Versa SASE</div>
                                <div class="vendor-desc">Unified SASE with SD-WAN, SSE, and CASB capabilities</div>
                                <span class="vendor-badge">Flexible</span>
                            </div>
                            <div class="vendor-card" data-vendor="cato">
                                <div class="vendor-icon">üöÄ</div>
                                <div class="vendor-name">Cato Networks</div>
                                <div class="vendor-desc">Cloud-native SASE with global backbone and zero-touch deployment</div>
                                <span class="vendor-badge">Simple</span>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Site Configuration -->
                    <div class="step-content" data-step="2">
                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üìç</span>
                                    Site Information
                                </div>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Site Name</label>
                                    <input type="text" id="site-name" value="HQ-NewYork" placeholder="e.g., HQ-NewYork">
                                </div>
                                <div class="form-group">
                                    <label>Site ID</label>
                                    <input type="text" id="site-id" value="1001" placeholder="Unique identifier">
                                </div>
                                <div class="form-group">
                                    <label>Region</label>
                                    <select id="site-region">
                                        <option value="us-east">US East</option>
                                        <option value="us-west">US West</option>
                                        <option value="eu-west">Europe West</option>
                                        <option value="asia-pacific">Asia Pacific</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Timezone</label>
                                    <select id="site-timezone">
                                        <option value="America/New_York">America/New_York</option>
                                        <option value="America/Los_Angeles">America/Los_Angeles</option>
                                        <option value="Europe/London">Europe/London</option>
                                        <option value="Asia/Singapore">Asia/Singapore</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üåê</span>
                                    WAN Connections
                                </div>
                                <button class="btn btn-secondary btn-icon" onclick="addWanInterface()">+</button>
                            </div>
                            <div id="wan-list" class="tunnel-list">
                                <div class="tunnel-item">
                                    <div class="tunnel-header">
                                        <div class="tunnel-title">üîå WAN-1 (Primary)</div>
                                        <div class="tunnel-badge">Active</div>
                                    </div>
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label>ISP Provider</label>
                                            <input type="text" value="Comcast" placeholder="e.g., Comcast">
                                        </div>
                                        <div class="form-group">
                                            <label>Bandwidth</label>
                                            <input type="text" value="100 Mbps" placeholder="e.g., 100 Mbps">
                                        </div>
                                        <div class="form-group">
                                            <label>WAN IP</label>
                                            <input type="text" value="203.0.113.10" placeholder="Public IP">
                                        </div>
                                        <div class="form-group">
                                            <label>Gateway</label>
                                            <input type="text" value="203.0.113.1" placeholder="Gateway IP">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üè¢</span>
                                    LAN Configuration
                                </div>
                                <button class="btn btn-secondary btn-icon" onclick="addLanSubnet()">+</button>
                            </div>
                            <div id="lan-list" class="form-grid">
                                <div class="form-group">
                                    <label>VLAN 10 - Corporate</label>
                                    <input type="text" value="10.1.10.0/24" placeholder="Subnet CIDR">
                                </div>
                                <div class="form-group">
                                    <label>VLAN 20 - Guest</label>
                                    <input type="text" value="10.1.20.0/24" placeholder="Subnet CIDR">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Tunnel Setup -->
                    <div class="step-content" data-step="3">
                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üîê</span>
                                    IPsec Tunnel Configuration
                                </div>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Tunnel Name</label>
                                    <input type="text" id="tunnel-name" value="HQ-to-SASE" placeholder="e.g., HQ-to-SASE">
                                </div>
                                <div class="form-group">
                                    <label>Remote Gateway</label>
                                    <input type="text" id="remote-gateway" value="gw.prismaaccess.com" placeholder="SASE gateway endpoint">
                                </div>
                                <div class="form-group">
                                    <label>Local IP</label>
                                    <input type="text" id="local-tunnel-ip" value="169.254.1.1/30" placeholder="Tunnel interface IP">
                                </div>
                                <div class="form-group">
                                    <label>Remote IP</label>
                                    <input type="text" id="remote-tunnel-ip" value="169.254.1.2/30" placeholder="Remote tunnel IP">
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üîë</span>
                                    IKE Configuration
                                </div>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>IKE Version</label>
                                    <select id="ike-version">
                                        <option value="ikev2">IKEv2 (Recommended)</option>
                                        <option value="ikev1">IKEv1</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Authentication</label>
                                    <select id="auth-method">
                                        <option value="psk">Pre-Shared Key</option>
                                        <option value="certificate">Certificate</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Encryption</label>
                                    <select id="encryption">
                                        <option value="aes256">AES-256-GCM</option>
                                        <option value="aes128">AES-128-GCM</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>DH Group</label>
                                    <select id="dh-group">
                                        <option value="14">DH Group 14 (2048-bit)</option>
                                        <option value="19">DH Group 19 (256-bit ECC)</option>
                                        <option value="20">DH Group 20 (384-bit ECC)</option>
                                    </select>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>Pre-Shared Key</label>
                                    <input type="password" id="psk" value="SuperSecretKey123!" placeholder="Enter strong PSK">
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>‚öôÔ∏è</span>
                                    IPsec SA Configuration
                                </div>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>ESP Encryption</label>
                                    <select id="esp-encryption">
                                        <option value="aes256">AES-256-GCM</option>
                                        <option value="aes128">AES-128-GCM</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>PFS Group</label>
                                    <select id="pfs-group">
                                        <option value="14">DH Group 14</option>
                                        <option value="19">DH Group 19</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Lifetime (seconds)</label>
                                    <input type="number" id="sa-lifetime" value="3600" placeholder="3600">
                                </div>
                                <div class="form-group">
                                    <label>DPD Interval</label>
                                    <input type="number" id="dpd-interval" value="10" placeholder="10 seconds">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Routing & BGP -->
                    <div class="step-content" data-step="4">
                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üîÄ</span>
                                    Static Routes
                                </div>
                                <div class="toggle-switch" id="static-routing-toggle"></div>
                            </div>
                            <div id="static-routes-config">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Default Route via Tunnel</label>
                                        <input type="text" value="0.0.0.0/0 via 169.254.1.2" placeholder="Route entry">
                                    </div>
                                    <div class="form-group">
                                        <label>Corporate Network</label>
                                        <input type="text" value="10.0.0.0/8 via 169.254.1.2" placeholder="Route entry">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üîÑ</span>
                                    BGP Configuration
                                </div>
                                <div class="toggle-switch active" id="bgp-toggle"></div>
                            </div>
                            <div id="bgp-config">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Local AS Number</label>
                                        <input type="text" id="local-asn" value="65001" placeholder="e.g., 65001">
                                    </div>
                                    <div class="form-group">
                                        <label>Remote AS Number</label>
                                        <input type="text" id="remote-asn" value="65000" placeholder="Provider ASN">
                                    </div>
                                    <div class="form-group">
                                        <label>Local BGP IP</label>
                                        <input type="text" value="169.254.1.1" placeholder="Tunnel interface IP">
                                    </div>
                                    <div class="form-group">
                                        <label>Remote BGP IP</label>
                                        <input type="text" value="169.254.1.2" placeholder="Remote BGP peer">
                                    </div>
                                </div>

                                <div class="form-group" style="margin-top: 20px;">
                                    <label>Advertised Networks (one per line)</label>
                                    <textarea id="advertised-networks" placeholder="10.1.10.0/24&#10;10.1.20.0/24&#10;192.168.0.0/16">10.1.10.0/24
10.1.20.0/24</textarea>
                                </div>

                                <div class="form-grid" style="margin-top: 20px;">
                                    <div class="form-group">
                                        <label>Keepalive Timer</label>
                                        <input type="number" value="30" placeholder="30 seconds">
                                    </div>
                                    <div class="form-group">
                                        <label>Hold Timer</label>
                                        <input type="number" value="90" placeholder="90 seconds">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Security Policies -->
                    <div class="step-content" data-step="5">
                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üõ°Ô∏è</span>
                                    Security Zones
                                </div>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Trusted Zone</label>
                                    <input type="text" value="trust" placeholder="Internal zone name">
                                </div>
                                <div class="form-group">
                                    <label>Untrusted Zone</label>
                                    <input type="text" value="untrust" placeholder="External zone name">
                                </div>
                                <div class="form-group">
                                    <label>SASE Zone</label>
                                    <input type="text" value="sase" placeholder="SASE connection zone">
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üî•</span>
                                    Default Security Policies
                                </div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">‚úì</div>
                                <div>
                                    <strong>Allow LAN to Internet via SASE</strong>
                                    <div style="font-size: 0.85em; color: var(--text-secondary);">trust ‚Üí sase ‚Üí Any destination</div>
                                </div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">‚úì</div>
                                <div>
                                    <strong>Block Internet to LAN</strong>
                                    <div style="font-size: 0.85em; color: var(--text-secondary);">untrust ‚Üí trust ‚Üí Deny all</div>
                                </div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">‚úì</div>
                                <div>
                                    <strong>Allow Remote Access via SASE</strong>
                                    <div style="font-size: 0.85em; color: var(--text-secondary);">sase ‚Üí trust ‚Üí Corporate resources</div>
                                </div>
                            </div>
                        </div>

                        <div class="config-section">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üîí</span>
                                    Advanced Security Features
                                </div>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 10px;">
                                        <input type="checkbox" checked style="width: auto;">
                                        Enable Threat Prevention
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 10px;">
                                        <input type="checkbox" checked style="width: auto;">
                                        Enable URL Filtering
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 10px;">
                                        <input type="checkbox" checked style="width: auto;">
                                        Enable SSL Decryption
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 10px;">
                                        <input type="checkbox" style="width: auto;">
                                        Enable DLP
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Review & Generate -->
                    <div class="step-content" data-step="6">
                        <div class="summary-grid">
                            <div class="summary-card">
                                <div class="summary-card-header">
                                    <span>üåê</span> SASE Platform
                                </div>
                                <div class="summary-value" id="summary-vendor">Prisma Access</div>
                                <div class="summary-detail">Palo Alto Networks cloud-delivered security</div>
                            </div>
                            <div class="summary-card">
                                <div class="summary-card-header">
                                    <span>üìç</span> Site Information
                                </div>
                                <div class="summary-value" id="summary-site">HQ-NewYork</div>
                                <div class="summary-detail">Site ID: 1001 | Region: US East</div>
                            </div>
                            <div class="summary-card">
                                <div class="summary-card-header">
                                    <span>üîê</span> Tunnels Configured
                                </div>
                                <div class="summary-value">1</div>
                                <div class="summary-detail">IPsec with IKEv2 and AES-256-GCM</div>
                            </div>
                            <div class="summary-card">
                                <div class="summary-card-header">
                                    <span>üîÑ</span> Routing Protocol
                                </div>
                                <div class="summary-value">BGP</div>
                                <div class="summary-detail">AS 65001 ‚Üí AS 65000</div>
                            </div>
                        </div>

                        <div class="config-section" style="margin-top: 30px;">
                            <div class="config-section-header">
                                <div class="config-section-title">
                                    <span>üì¶</span>
                                    Generated Terraform Modules
                                </div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">üìÑ</div>
                                <div><strong>main.tf</strong> - Core SASE configuration</div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">üìÑ</div>
                                <div><strong>ipsec.tf</strong> - IPsec tunnel definitions</div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">üìÑ</div>
                                <div><strong>bgp.tf</strong> - BGP routing configuration</div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">üìÑ</div>
                                <div><strong>security.tf</strong> - Security policies and zones</div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">üìÑ</div>
                                <div><strong>variables.tf</strong> - Input variables</div>
                            </div>
                            <div class="list-item">
                                <div class="list-icon">üìÑ</div>
                                <div><strong>outputs.tf</strong> - Resource outputs</div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 16px; margin-top: 30px;">
                            <button class="btn btn-success" style="flex: 1;" onclick="showCodeModal()">
                                üíª View Generated Code
                            </button>
                            <button class="btn btn-primary" style="flex: 1;" onclick="exportAllFiles()">
                                üì• Download Complete Module
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="nav-buttons">
                    <button class="btn btn-secondary" id="prev-btn" onclick="previousStep()" style="display: none;">
                        ‚Üê Previous
                    </button>
                    <button class="btn btn-primary" id="next-btn" onclick="nextStep()">
                        Next Step ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Code Modal -->
    <div class="code-modal" id="code-modal">
        <div class="code-modal-content">
            <div class="code-modal-header">
                <div class="code-modal-title">Generated Terraform Configuration</div>
                <div style="display: flex; gap: 12px;">
                    <button class="btn btn-secondary" onclick="copyCurrentCode()">üìã Copy</button>
                    <button class="btn btn-secondary" onclick="closeCodeModal()">‚úï Close</button>
                </div>
            </div>
            <div class="code-modal-tabs">
                <button class="code-modal-tab active" data-file="main">main.tf</button>
                <button class="code-modal-tab" data-file="ipsec">ipsec.tf</button>
                <button class="code-modal-tab" data-file="bgp">bgp.tf</button>
                <button class="code-modal-tab" data-file="security">security.tf</button>
                <button class="code-modal-tab" data-file="variables">variables.tf</button>
                <button class="code-modal-tab" data-file="outputs">outputs.tf</button>
            </div>
            <div class="code-modal-body">
                <pre><code id="modal-code-output" class="language-hcl"># Generated code will appear here</code></pre>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedVendor = null;
        let config = {
            vendor: '',
            site: {},
            tunnels: {},
            routing: {},
            security: {}
        };
        let generatedCode = {
            main: '',
            ipsec: '',
            bgp: '',
            security: '',
            variables: '',
            outputs: ''
        };

        // Initialize
        document.querySelectorAll('.vendor-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.vendor-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedVendor = this.dataset.vendor;
                config.vendor = selectedVendor;
            });
        });

        document.querySelectorAll('.step-item').forEach(item => {
            item.addEventListener('click', function() {
                const step = parseInt(this.dataset.step);
                if (step <= currentStep || item.classList.contains('completed')) {
                    goToStep(step);
                }
            });
        });

        document.querySelectorAll('.code-modal-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.code-modal-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                updateModalCode(this.dataset.file);
            });
        });

        document.querySelectorAll('.toggle-switch').forEach(toggle => {
            toggle.addEventListener('click', function() {
                this.classList.toggle('active');
            });
        });

        function goToStep(step) {
            if (step < 1 || step > 6) return;
            
            // Update step items
            document.querySelectorAll('.step-item').forEach(item => {
                item.classList.remove('active');
                const itemStep = parseInt(item.dataset.step);
                if (itemStep < step) {
                    item.classList.add('completed');
                }
                if (itemStep === step) {
                    item.classList.add('active');
                }
            });

            // Update content
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
                if (parseInt(content.dataset.step) === step) {
                    content.classList.add('active');
                }
            });

            // Update header
            const titles = {
                1: { title: 'Select Your SASE Vendor', desc: 'Choose the SASE platform you want to deploy and configure' },
                2: { title: 'Configure Site Details', desc: 'Define your site location, WAN connections, and LAN networks' },
                3: { title: 'IPsec Tunnel Configuration', desc: 'Set up secure tunnels with IKE and IPsec parameters' },
                4: { title: 'Routing & BGP Setup', desc: 'Configure dynamic routing with BGP for optimal path selection' },
                5: { title: 'Security Policies', desc: 'Define security zones, policies, and advanced protection features' },
                6: { title: 'Review & Generate', desc: 'Review your configuration and generate Terraform code' }
            };

            document.getElementById('step-title').textContent = titles[step].title;
            document.getElementById('step-description').textContent = titles[step].desc;

            // Update progress bar
            const progress = (step / 6) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';

            // Update navigation buttons
            document.getElementById('prev-btn').style.display = step > 1 ? 'block' : 'none';
            document.getElementById('next-btn').textContent = step === 6 ? 'Generate Code ‚ú®' : 'Next Step ‚Üí';

            currentStep = step;

            // Generate code on final step
            if (step === 6) {
                generateAllCode();
            }
        }

        function nextStep() {
            if (currentStep === 1 && !selectedVendor) {
                alert('Please select a SASE vendor first');
                return;
            }
            if (currentStep < 6) {
                goToStep(currentStep + 1);
            } else {
                showCodeModal();
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                goToStep(currentStep - 1);
            }
        }

        function resetWizard() {
            if (confirm('Are you sure you want to reset? All configuration will be lost.')) {
                currentStep = 1;
                selectedVendor = null;
                config = { vendor: '', site: {}, tunnels: {}, routing: {}, security: {} };
                document.querySelectorAll('.vendor-card').forEach(c => c.classList.remove('selected'));
                goToStep(1);
            }
        }

        function saveProgress() {
            localStorage.setItem('sase-config', JSON.stringify(config));
            alert('‚úì Progress saved to browser storage');
        }

        function generateAllCode() {
            const vendor = config.vendor || selectedVendor || 'prisma';
            
            if (vendor === 'prisma') {
                generatePrismaCode();
            } else if (vendor === 'zscaler') {
                generateZscalerCode();
            } else if (vendor === 'fortinet') {
                generateFortinetCode();
            } else {
                generateGenericCode();
            }

            document.getElementById('summary-vendor').textContent = vendor.charAt(0).toUpperCase() + vendor.slice(1);
        }

        function generatePrismaCode() {
            const siteName = document.getElementById('site-name')?.value || 'HQ-NewYork';
            const tunnelName = document.getElementById('tunnel-name')?.value || 'HQ-to-SASE';
            const localAsn = document.getElementById('local-asn')?.value || '65001';
            const remoteAsn = document.getElementById('remote-asn')?.value || '65000';

            generatedCode.main = `# Prisma Access SASE Configuration
# Generated by SASE Bootstrapper

terraform {
  required_version = ">= 1.0"
  required_providers {
    panos = {
      source  = "PaloAltoNetworks/panos"
      version = "~> 1.11"
    }
  }
}

provider "panos" {
  hostname = var.panorama_host
  username = var.panorama_username
  password = var.panorama_password
}

# Device Group for SASE Configuration
resource "panos_panorama_device_group" "sase_dg" {
  name        = var.device_group_name
  description = "SASE deployment for ${siteName}"
}

# Template Stack
resource "panos_panorama_template_stack" "sase_template" {
  name        = "\${var.template_name}-stack"
  description = "Template stack for SASE deployment"
  templates   = [var.template_name]
}`;

            generatedCode.ipsec = `# IPsec Tunnel Configuration for Prisma Access

# IKE Crypto Profile
resource "panos_panorama_ike_crypto_profile" "sase_ike" {
  template       = var.template_name
  name           = "${tunnelName}-ike-profile"
  dh_groups      = ["group14", "group19"]
  authentications = ["sha256"]
  encryptions    = ["aes-256-gcm"]
  lifetime_hours = 8
}

# IPsec Crypto Profile
resource "panos_panorama_ipsec_crypto_profile" "sase_ipsec" {
  template = var.template_name
  name     = "${tunnelName}-ipsec-profile"
  
  protocol          = "esp"
  authentications   = ["sha256"]
  encryptions       = ["aes-256-gcm"]
  dh_group          = "group14"
  lifetime_hours    = 1
  lifesize_kb       = 0
}

# IKE Gateway
resource "panos_panorama_ike_gateway" "sase_gateway" {
  template             = var.template_name
  name                 = "${tunnelName}-gateway"
  version              = "ikev2"
  interface            = var.wan_interface
  peer_ip_type         = "ip"
  peer_ip_value        = var.remote_gateway
  pre_shared_key       = var.ipsec_psk
  ike_crypto_profile   = panos_panorama_ike_crypto_profile.sase_ike.name
}

# IPsec Tunnel
resource "panos_panorama_ipsec_tunnel" "sase_tunnel" {
  template               = var.template_name
  name                   = "${tunnelName}"
  tunnel_interface       = "tunnel.1"
  anti_replay            = true
  ipsec_crypto_profile   = panos_panorama_ipsec_crypto_profile.sase_ipsec.name
  ike_gateway            = panos_panorama_ike_gateway.sase_gateway.name
  enable_tunnel_monitor  = true
  tunnel_monitor_dest_ip = var.tunnel_monitor_ip
}

# Tunnel Interface
resource "panos_panorama_tunnel_interface" "sase_tunnel_if" {
  template       = var.template_name
  name           = "tunnel.1"
  comment        = "SASE tunnel interface"
  static_ips     = [var.local_tunnel_ip]
  management_profile = var.mgmt_profile
}`;

            generatedCode.bgp = `# BGP Configuration for Dynamic Routing

# Virtual Router
resource "panos_panorama_virtual_router" "sase_vr" {
  template = var.template_name
  name     = var.virtual_router_name
  interfaces = [
    panos_panorama_tunnel_interface.sase_tunnel_if.name,
    var.lan_interface
  ]
}

# BGP Configuration
resource "panos_panorama_bgp" "sase_bgp" {
  template          = var.template_name
  virtual_router    = panos_panorama_virtual_router.sase_vr.name
  router_id         = var.bgp_router_id
  as_number         = "${localAsn}"
  enable            = true
  install_route     = true
}

# BGP Peer Group
resource "panos_panorama_bgp_peer_group" "sase_peer_group" {
  template       = var.template_name
  virtual_router = panos_panorama_virtual_router.sase_vr.name
  name           = "sase-peers"
  type           = "ebgp"
  
  depends_on = [panos_panorama_bgp.sase_bgp]
}

# BGP Peer to SASE
resource "panos_panorama_bgp_peer" "sase_peer" {
  template            = var.template_name
  virtual_router      = panos_panorama_virtual_router.sase_vr.name
  bgp_peer_group      = panos_panorama_bgp_peer_group.sase_peer_group.name
  name                = "prisma-access-peer"
  peer_as             = "${remoteAsn}"
  local_address_interface = panos_panorama_tunnel_interface.sase_tunnel_if.name
  local_address_ip    = split("/", var.local_tunnel_ip)[0]
  peer_address_ip     = var.remote_bgp_ip
  enable              = true
  keep_alive_interval = 30
  hold_time           = 90
}

# BGP Network Advertisement
resource "panos_panorama_bgp_redist_rule" "advertise_static" {
  template       = var.template_name
  virtual_router = panos_panorama_virtual_router.sase_vr.name
  name           = "advertise-lan-networks"
  enable         = true
  route_table    = "unicast"
  address_family = "ipv4"
  types          = ["static"]
  
  depends_on = [panos_panorama_bgp.sase_bgp]
}`;

            generatedCode.security = `# Security Policies and Zones

# Security Zone - Trust (LAN)
resource "panos_panorama_zone" "trust" {
  template   = var.template_name
  name       = "trust"
  mode       = "layer3"
  interfaces = [var.lan_interface]
}

# Security Zone - SASE (Tunnel)
resource "panos_panorama_zone" "sase" {
  template   = var.template_name
  name       = "sase"
  mode       = "layer3"
  interfaces = [panos_panorama_tunnel_interface.sase_tunnel_if.name]
}

# Security Zone - Untrust (Internet)
resource "panos_panorama_zone" "untrust" {
  template   = var.template_name
  name       = "untrust"
  mode       = "layer3"
  interfaces = [var.wan_interface]
}

# Security Policy - LAN to SASE
resource "panos_panorama_security_policy" "lan_to_sase" {
  device_group = panos_panorama_device_group.sase_dg.name
  rulebase     = "pre-rulebase"
  
  rule {
    name                  = "Allow-LAN-to-Internet-via-SASE"
    source_zones          = [panos_panorama_zone.trust.name]
    source_addresses      = ["any"]
    destination_zones     = [panos_panorama_zone.sase.name]
    destination_addresses = ["any"]
    applications          = ["any"]
    services              = ["application-default"]
    categories            = ["any"]
    action                = "allow"
    log_end               = true
  }
}

# Security Policy - SASE to LAN (Remote Access)
resource "panos_panorama_security_policy" "sase_to_lan" {
  device_group = panos_panorama_device_group.sase_dg.name
  rulebase     = "pre-rulebase"
  
  rule {
    name                  = "Allow-Remote-Access-to-LAN"
    source_zones          = [panos_panorama_zone.sase.name]
    source_addresses      = ["any"]
    destination_zones     = [panos_panorama_zone.trust.name]
    destination_addresses = [var.lan_network]
    applications          = ["any"]
    services              = ["application-default"]
    categories            = ["any"]
    action                = "allow"
    log_end               = true
  }
}

# Security Policy - Block Untrust to Trust
resource "panos_panorama_security_policy" "block_internet_to_lan" {
  device_group = panos_panorama_device_group.sase_dg.name
  rulebase     = "pre-rulebase"
  
  rule {
    name                  = "Block-Internet-to-LAN"
    source_zones          = [panos_panorama_zone.untrust.name]
    source_addresses      = ["any"]
    destination_zones     = [panos_panorama_zone.trust.name]
    destination_addresses = ["any"]
    applications          = ["any"]
    services              = ["any"]
    categories            = ["any"]
    action                = "deny"
    log_end               = true
  }
}

# Security Profile Group (Optional - Threat Prevention)
resource "panos_panorama_security_profile_group" "sase_profiles" {
  device_group        = panos_panorama_device_group.sase_dg.name
  name                = "sase-security-profiles"
  virus_profile       = "default"
  spyware_profile     = "default"
  vulnerability_profile = "default"
  url_filtering_profile = "default"
  file_blocking_profile = "default"
}`;

            generatedCode.variables = `# Variables for Prisma Access SASE Configuration

variable "panorama_host" {
  description = "Panorama hostname or IP"
  type        = string
}

variable "panorama_username" {
  description = "Panorama admin username"
  type        = string
}

variable "panorama_password" {
  description = "Panorama admin password"
  type        = string
  sensitive   = true
}

variable "device_group_name" {
  description = "Name of the device group"
  type        = string
  default     = "${siteName}-dg"
}

variable "template_name" {
  description = "Name of the template"
  type        = string
  default     = "${siteName}-template"
}

variable "virtual_router_name" {
  description = "Name of the virtual router"
  type        = string
  default     = "default"
}

variable "wan_interface" {
  description = "WAN interface name"
  type        = string
  default     = "ethernet1/1"
}

variable "lan_interface" {
  description = "LAN interface name"
  type        = string
  default     = "ethernet1/2"
}

variable "remote_gateway" {
  description = "Remote SASE gateway IP or hostname"
  type        = string
  default     = "gw.prismaaccess.com"
}

variable "ipsec_psk" {
  description = "IPsec pre-shared key"
  type        = string
  sensitive   = true
}

variable "local_tunnel_ip" {
  description = "Local tunnel interface IP with CIDR"
  type        = string
  default     = "169.254.1.1/30"
}

variable "remote_bgp_ip" {
  description = "Remote BGP peer IP"
  type        = string
  default     = "169.254.1.2"
}

variable "bgp_router_id" {
  description = "BGP router ID"
  type        = string
  default     = "169.254.1.1"
}

variable "lan_network" {
  description = "LAN network CIDR"
  type        = string
  default     = "10.1.0.0/16"
}

variable "tunnel_monitor_ip" {
  description = "IP to monitor tunnel health"
  type        = string
  default     = "169.254.1.2"
}

variable "mgmt_profile" {
  description = "Management profile for tunnel interface"
  type        = string
  default     = "default"
}`;

            generatedCode.outputs = `# Outputs for Prisma Access SASE Configuration

output "device_group_name" {
  description = "Name of the created device group"
  value       = panos_panorama_device_group.sase_dg.name
}

output "template_stack_name" {
  description = "Name of the template stack"
  value       = panos_panorama_template_stack.sase_template.name
}

output "ipsec_tunnel_name" {
  description = "Name of the IPsec tunnel"
  value       = panos_panorama_ipsec_tunnel.sase_tunnel.name
}

output "tunnel_interface" {
  description = "Tunnel interface name"
  value       = panos_panorama_tunnel_interface.sase_tunnel_if.name
}

output "bgp_as_number" {
  description = "Local BGP AS number"
  value       = panos_panorama_bgp.sase_bgp.as_number
}

output "bgp_peer_name" {
  description = "BGP peer name"
  value       = panos_panorama_bgp_peer.sase_peer.name
}

output "security_zones" {
  description = "Created security zones"
  value = {
    trust   = panos_panorama_zone.trust.name
    sase    = panos_panorama_zone.sase.name
    untrust = panos_panorama_zone.untrust.name
  }
}`;
        }

        function generateZscalerCode() {
            generatedCode.main = `# Zscaler SASE Configuration
# Generated by SASE Bootstrapper

terraform {
  required_version = ">= 1.0"
  required_providers {
    zpa = {
      source  = "zscaler/zpa"
      version = "~> 2.0"
    }
    zia = {
      source  = "zscaler/zia"
      version = "~> 2.0"
    }
  }
}

provider "zpa" {
  client_id     = var.zpa_client_id
  client_secret = var.zpa_client_secret
  customer_id   = var.zpa_customer_id
}

provider "zia" {
  username = var.zia_username
  password = var.zia_password
  api_key  = var.zia_api_key
  cloud    = var.zia_cloud
}

# ZPA Application Segment
resource "zpa_application_segment" "corporate_apps" {
  name                      = "Corporate Applications"
  description               = "Internal corporate applications"
  enabled                   = true
  domain_names              = var.app_domains
  server_groups             = [zpa_server_group.main.id]
  segment_group_id          = zpa_segment_group.main.id
  
  tcp_port_ranges           = ["80", "80", "443", "443"]
  udp_port_ranges           = []
}`;

            generatedCode.ipsec = `# ZIA GRE Tunnel Configuration

resource "zia_gre_tunnel" "main" {
  source_ip       = var.wan_public_ip
  comment         = "Primary GRE tunnel to ZIA"
  ip_unnumbered   = false
  
  internal_ip_range = "10.255.255.1"
  
  within_country    = false
  country_code      = var.country_code
  
  primary_dest_vip {
    id                = var.zia_datacenter_id
    virtual_ip        = var.zia_primary_vip
  }
}`;

            generatedCode.bgp = `# Static Routes for Zscaler
# Zscaler uses static routing via GRE tunnels

resource "zia_traffic_forwarding_static_ip" "wan_ip" {
  ip_address  = var.wan_public_ip
  comment     = "WAN IP for GRE tunnel source"
  geo_override = false
}`;

            generatedCode.security = `# ZIA URL Filtering Policies

resource "zia_url_filtering_rules" "allow_corporate" {
  name                = "Allow Corporate Traffic"
  description         = "Allow access to corporate applications"
  enabled             = true
  order               = 1
  state               = "ENABLED"
  action              = "ALLOW"
  
  url_categories      = var.allowed_categories
  
  locations {
    id = zia_location_management.main.id
  }
}

# ZIA Firewall Rule
resource "zia_firewall_filtering_rule" "allow_outbound" {
  name                    = "Allow Outbound Internet"
  description             = "Allow users to access internet"
  enabled                 = true
  order                   = 1
  action                  = "ALLOW"
  state                   = "ENABLED"
  
  source_ip_groups        = [var.lan_network]
  dest_addresses          = ["0.0.0.0/0"]
  
  enable_full_logging     = true
}`;

            generatedCode.variables = `# Zscaler Configuration Variables

variable "zpa_client_id" {
  description = "ZPA API client ID"
  type        = string
  sensitive   = true
}

variable "zpa_client_secret" {
  description = "ZPA API client secret"
  type        = string
  sensitive   = true
}

variable "zpa_customer_id" {
  description = "ZPA customer ID"
  type        = string
}

variable "zia_username" {
  description = "ZIA admin username"
  type        = string
}

variable "zia_password" {
  description = "ZIA admin password"
  type        = string
  sensitive   = true
}

variable "zia_api_key" {
  description = "ZIA API key"
  type        = string
  sensitive   = true
}

variable "zia_cloud" {
  description = "ZIA cloud name"
  type        = string
  default     = "zscaler.net"
}

variable "wan_public_ip" {
  description = "WAN public IP for GRE tunnel"
  type        = string
}

variable "app_domains" {
  description = "Application domains for ZPA"
  type        = list(string)
  default     = ["*.company.com"]
}`;

            generatedCode.outputs = `# Zscaler Outputs

output "gre_tunnel_id" {
  description = "ZIA GRE tunnel ID"
  value       = zia_gre_tunnel.main.id
}

output "zpa_app_segment_id" {
  description = "ZPA application segment ID"
  value       = zpa_application_segment.corporate_apps.id
}`;
        }

        function generateFortinetCode() {
            generatedCode.main = `# Fortinet SASE Configuration
# Generated by SASE Bootstrapper

terraform {
  required_version = ">= 1.0"
  required_providers {
    fortios = {
      source  = "fortinetdev/fortios"
      version = "~> 1.18"
    }
  }
}

provider "fortios" {
  hostname = var.fortigate_host
  token    = var.fortigate_token
  insecure = "false"
}

# System Interface Configuration
resource "fortios_system_interface" "wan" {
  name          = "wan1"
  vdom          = "root"
  mode          = "static"
  ip            = var.wan_ip
  allowaccess   = "ping https ssh"
  type          = "physical"
  interface     = "wan1"
}`;

            generatedCode.ipsec = `# FortiSASE IPsec VPN Configuration

resource "fortios_vpnipsec_phase1interface" "sase_tunnel" {
  name           = "sase-tunnel-1"
  interface      = "wan1"
  peertype       = "any"
  proposal       = "aes256-sha256"
  dpd_retrycount = 3
  remote_gw      = var.remote_gateway
  psksecret      = var.ipsec_psk
  ike_version    = 2
  
  dpd            = "on-demand"
  nattraversal   = "enable"
}

resource "fortios_vpnipsec_phase2interface" "sase_tunnel_p2" {
  name          = "sase-tunnel-1-p2"
  phase1name    = fortios_vpnipsec_phase1interface.sase_tunnel.name
  proposal      = "aes256-sha256"
  pfs           = "enable"
  dhgrp         = "14"
  
  src_subnet    = var.lan_subnet
  dst_subnet    = "0.0.0.0/0"
}`;

            generatedCode.bgp = `# FortiGate BGP Configuration

resource "fortios_router_bgp" "main" {
  as                    = var.local_asn
  router_id             = var.bgp_router_id
  
  neighbor {
    ip               = var.remote_bgp_ip
    remote_as        = var.remote_asn
    keep_alive_timer = 30
    holdtime_timer   = 90
  }
  
  network {
    prefix = var.lan_subnet
  }
}`;

            generatedCode.security = `# FortiGate Firewall Policies

resource "fortios_firewall_policy" "lan_to_sase" {
  name        = "LAN-to-SASE"
  action      = "accept"
  logtraffic  = "all"
  
  srcintf {
    name = "internal"
  }
  
  dstintf {
    name = fortios_vpnipsec_phase1interface.sase_tunnel.name
  }
  
  srcaddr {
    name = "all"
  }
  
  dstaddr {
    name = "all"
  }
  
  service {
    name = "ALL"
  }
  
  schedule = "always"
  nat      = "enable"
}`;

            generatedCode.variables = `# Fortinet Configuration Variables

variable "fortigate_host" {
  description = "FortiGate hostname or IP"
  type        = string
}

variable "fortigate_token" {
  description = "FortiGate API token"
  type        = string
  sensitive   = true
}

variable "wan_ip" {
  description = "WAN interface IP with netmask"
  type        = string
  default     = "203.0.113.10/24"
}

variable "remote_gateway" {
  description = "Remote SASE gateway IP"
  type        = string
}

variable "ipsec_psk" {
  description = "IPsec pre-shared key"
  type        = string
  sensitive   = true
}

variable "lan_subnet" {
  description = "LAN subnet CIDR"
  type        = string
  default     = "10.1.0.0/16"
}

variable "local_asn" {
  description = "Local BGP AS number"
  type        = string
  default     = "65001"
}

variable "remote_asn" {
  description = "Remote BGP AS number"
  type        = string
  default     = "65000"
}`;

            generatedCode.outputs = `# Fortinet Outputs

output "ipsec_tunnel_name" {
  description = "IPsec tunnel interface name"
  value       = fortios_vpnipsec_phase1interface.sase_tunnel.name
}

output "bgp_as" {
  description = "Local BGP AS number"
  value       = fortios_router_bgp.main.as
}`;
        }

        function generateGenericCode() {
            generatedCode.main = `# Generic SASE Configuration
# This is a template - customize for your specific vendor

terraform {
  required_version = ">= 1.0"
}

# Configure your SASE provider here
# Replace with vendor-specific resources`;
            
            generatedCode.ipsec = '# IPsec configuration placeholder';
            generatedCode.bgp = '# BGP configuration placeholder';
            generatedCode.security = '# Security policies placeholder';
            generatedCode.variables = '# Variables placeholder';
            generatedCode.outputs = '# Outputs placeholder';
        }

        function showCodeModal() {
            document.getElementById('code-modal').classList.add('show');
            updateModalCode('main');
        }

        function closeCodeModal() {
            document.getElementById('code-modal').classList.remove('show');
        }

        function updateModalCode(file) {
            const output = document.getElementById('modal-code-output');
            output.textContent = generatedCode[file] || '# No code generated';
            Prism.highlightElement(output);
        }

        function copyCurrentCode() {
            const activeTab = document.querySelector('.code-modal-tab.active');
            const file = activeTab.dataset.file;
            const code = generatedCode[file];
            
            navigator.clipboard.writeText(code).then(() => {
                alert('‚úì Code copied to clipboard!');
            });
        }

        function exportAllFiles() {
            const files = {
                'main.tf': generatedCode.main,
                'ipsec.tf': generatedCode.ipsec,
                'bgp.tf': generatedCode.bgp,
                'security.tf': generatedCode.security,
                'variables.tf': generatedCode.variables,
                'outputs.tf': generatedCode.outputs,
                'README.md': generateReadme()
            };

            Object.entries(files).forEach(([filename, content]) => {
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                URL.revokeObjectURL(url);
            });

            alert('‚úì All files downloaded successfully!');
        }

        function generateReadme() {
            const vendor = selectedVendor || 'sase';
            return `# ${vendor.toUpperCase()} SASE Deployment

Generated by SASE Bootstrapper

## Prerequisites

1. Terraform >= 1.0
2. Access credentials for your SASE platform
3. Valid network configuration

## Deployment Steps

\`\`\`bash
# Initialize Terraform
terraform init

# Review the plan
terraform plan

# Apply configuration
terraform apply

# Verify deployment
terraform show
\`\`\`

## Configuration Files

- **main.tf**: Core SASE configuration
- **ipsec.tf**: IPsec tunnel definitions
- **bgp.tf**: BGP routing configuration
- **security.tf**: Security policies
- **variables.tf**: Input variables
- **outputs.tf**: Output values

## Customization

Edit \`variables.tf\` to customize:
- Network ranges
- Tunnel parameters
- BGP AS numbers
- Security policies

## Support

For issues or questions, refer to your SASE vendor documentation.
`;
        }

        function addWanInterface() {
            const wanList = document.getElementById('wan-list');
            const newWan = document.createElement('div');
            newWan.className = 'tunnel-item';
            newWan.innerHTML = `
                <div class="tunnel-header">
                    <div class="tunnel-title">üîå WAN-${wanList.children.length + 1}</div>
                    <div class="tunnel-badge">New</div>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ISP Provider</label>
                        <input type="text" placeholder="ISP name">
                    </div>
                    <div class="form-group">
                        <label>Bandwidth</label>
                        <input type="text" placeholder="e.g., 100 Mbps">
                    </div>
                    <div class="form-group">
                        <label>WAN IP</label>
                        <input type="text" placeholder="Public IP">
                    </div>
                    <div class="form-group">
                        <label>Gateway</label>
                        <input type="text" placeholder="Gateway IP">
                    </div>
                </div>
            `;
            wanList.appendChild(newWan);
        }

        function addLanSubnet() {
            const lanList = document.getElementById('lan-list');
            const vlanNum = lanList.children.length + 1;
            const newLan = document.createElement('div');
            newLan.className = 'form-group';
            newLan.innerHTML = `
                <label>VLAN ${vlanNum * 10} - Custom</label>
                <input type="text" placeholder="Subnet CIDR">
            `;
            lanList.appendChild(newLan);
        }

        // Close modal on background click
        document.getElementById('code-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCodeModal();
            }
        });

        // Initialize first vendor selection
        window.addEventListener('load', () => {
            document.querySelector('.vendor-card[data-vendor="prisma"]').click();
        });
    </script>
</body>
</html>
