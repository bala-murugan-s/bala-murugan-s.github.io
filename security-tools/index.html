<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Tools - Balamurugan S</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState } = React;

        function App() {
            const [activeTab, setActiveTab] = useState('password');

            // Password Analyzer
            const PasswordAnalyzer = () => {
                const [password, setPassword] = useState('');
                const [analysis, setAnalysis] = useState(null);

                const analyzePassword = (pwd) => {
                    setPassword(pwd);
                    if (!pwd) {
                        setAnalysis(null);
                        return;
                    }

                    const checks = {
                        length: pwd.length >= 12,
                        uppercase: /[A-Z]/.test(pwd),
                        lowercase: /[a-z]/.test(pwd),
                        numbers: /[0-9]/.test(pwd),
                        special: /[^A-Za-z0-9]/.test(pwd)
                    };

                    const score = Object.values(checks).filter(Boolean).length;
                    const strength = score <= 2 ? 'Weak' : score <= 3 ? 'Medium' : score <= 4 ? 'Strong' : 'Very Strong';
                    const color = score <= 2 ? '#ef4444' : score <= 3 ? '#eab308' : score <= 4 ? '#3b82f6' : '#22c55e';

                    setAnalysis({ checks, score, strength, color, length: pwd.length });
                };

                return (
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <h3 className="text-2xl font-bold mb-4">Password Strength Analyzer</h3>
                        <div className="mb-4">
                            <label className="block text-sm font-medium mb-2">Enter Password</label>
                            <input
                                type="text"
                                value={password}
                                onChange={(e) => analyzePassword(e.target.value)}
                                className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:outline-none font-mono"
                                placeholder="Type your password..."
                            />
                        </div>
                        {analysis && (
                            <div>
                                <div className="mb-4">
                                    <div className="flex justify-between mb-2">
                                        <span className="font-medium">Strength: {analysis.strength}</span>
                                        <span className="text-sm text-gray-600">Length: {analysis.length}</span>
                                    </div>
                                    <div className="w-full bg-gray-200 rounded-full h-3">
                                        <div
                                            className="h-3 rounded-full transition-all"
                                            style={{ width: `${(analysis.score / 5) * 100}%`, backgroundColor: analysis.color }}
                                        />
                                    </div>
                                </div>
                                <div className="space-y-2">
                                    {Object.entries(analysis.checks).map(([key, value]) => (
                                        <div key={key} className="flex items-center gap-2">
                                            <div className={`w-5 h-5 rounded-full flex items-center justify-center ${value ? 'bg-green-500' : 'bg-gray-300'}`}>
                                                {value && <span className="text-white text-xs">✓</span>}
                                            </div>
                                            <span className={value ? 'text-gray-700' : 'text-gray-400'}>
                                                {key === 'length' ? '12+ characters' :
                                                 key === 'uppercase' ? 'Uppercase letters' :
                                                 key === 'lowercase' ? 'Lowercase letters' :
                                                 key === 'numbers' ? 'Numbers' : 'Special characters'}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            // Hash Generator
            const HashGenerator = () => {
                const [text, setText] = useState('');
                const [hashes, setHashes] = useState(null);

                const generateHashes = async (input) => {
                    setText(input);
                    if (!input) {
                        setHashes(null);
                        return;
                    }

                    const encoder = new TextEncoder();
                    const data = encoder.encode(input);

                    const sha256Hash = await crypto.subtle.digest('SHA-256', data);
                    const sha256 = Array.from(new Uint8Array(sha256Hash))
                        .map(b => b.toString(16).padStart(2, '0'))
                        .join('');

                    const sha1Hash = await crypto.subtle.digest('SHA-1', data);
                    const sha1 = Array.from(new Uint8Array(sha1Hash))
                        .map(b => b.toString(16).padStart(2, '0'))
                        .join('');

                    setHashes({ sha256, sha1 });
                };

                return (
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <h3 className="text-2xl font-bold mb-4">Hash Generator</h3>
                        <div className="mb-4">
                            <label className="block text-sm font-medium mb-2">Enter Text</label>
                            <textarea
                                value={text}
                                onChange={(e) => generateHashes(e.target.value)}
                                className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
                                rows="3"
                                placeholder="Enter text to hash..."
                            />
                        </div>
                        {hashes && (
                            <div className="space-y-4">
                                <div className="bg-gray-50 p-4 rounded-lg">
                                    <p className="text-sm font-semibold text-gray-600 mb-2">SHA-256</p>
                                    <p className="font-mono text-sm break-all">{hashes.sha256}</p>
                                </div>
                                <div className="bg-gray-50 p-4 rounded-lg">
                                    <p className="text-sm font-semibold text-gray-600 mb-2">SHA-1 (Legacy)</p>
                                    <p className="font-mono text-sm break-all">{hashes.sha1}</p>
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            // OWASP Top 10
            const OWASPReference = () => {
                const owasp = [
                    { rank: 1, name: 'Broken Access Control', risk: 'Critical', desc: 'Restrictions not properly enforced' },
                    { rank: 2, name: 'Cryptographic Failures', risk: 'High', desc: 'Sensitive data exposure' },
                    { rank: 3, name: 'Injection', risk: 'High', desc: 'SQL, NoSQL, OS, LDAP injection' },
                    { rank: 4, name: 'Insecure Design', risk: 'High', desc: 'Missing or ineffective control design' },
                    { rank: 5, name: 'Security Misconfiguration', risk: 'High', desc: 'Insecure default configs' },
                    { rank: 6, name: 'Vulnerable Components', risk: 'High', desc: 'Using components with known vulnerabilities' },
                    { rank: 7, name: 'Authentication Failures', risk: 'High', desc: 'Broken authentication mechanisms' },
                    { rank: 8, name: 'Software & Data Integrity', risk: 'Medium', desc: 'Unverified CI/CD pipeline' },
                    { rank: 9, name: 'Security Logging Failures', risk: 'Medium', desc: 'Insufficient logging' },
                    { rank: 10, name: 'SSRF', risk: 'Medium', desc: 'Server-Side Request Forgery' }
                ];

                return (
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <h3 className="text-2xl font-bold mb-4">OWASP Top 10 (2021)</h3>
                        <div className="space-y-3">
                            {owasp.map((item) => (
                                <div key={item.rank} className="border-l-4 border-red-500 bg-gray-50 p-4 rounded-r-lg">
                                    <div className="flex items-center justify-between mb-2">
                                        <h4 className="font-bold text-lg">#{item.rank} - {item.name}</h4>
                                        <span className={`px-3 py-1 rounded-full text-xs font-semibold ${
                                            item.risk === 'Critical' ? 'bg-red-100 text-red-700' :
                                            item.risk === 'High' ? 'bg-orange-100 text-orange-700' :
                                            'bg-yellow-100 text-yellow-700'
                                        }`}>
                                            {item.risk}
                                        </span>
                                    </div>
                                    <p className="text-gray-600 text-sm">{item.desc}</p>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            // Security Best Practices
            const BestPractices = () => {
                const practices = [
                    {
                        category: 'Authentication',
                        items: ['Implement MFA everywhere', 'Use strong password policies', 'Implement account lockout', 'Use OAuth/SAML for SSO']
                    },
                    {
                        category: 'Encryption',
                        items: ['TLS 1.3 for data in transit', 'AES-256 for data at rest', 'Proper key management', 'Certificate pinning for mobile']
                    },
                    {
                        category: 'Access Control',
                        items: ['Principle of least privilege', 'Zero Trust architecture', 'Regular access reviews', 'Just-in-time access']
                    },
                    {
                        category: 'Monitoring',
                        items: ['SIEM integration', 'Real-time alerting', 'Log retention policies', 'Incident response plan']
                    }
                ];

                return (
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <h3 className="text-2xl font-bold mb-4">Security Best Practices</h3>
                        <div className="grid md:grid-cols-2 gap-6">
                            {practices.map((practice, idx) => (
                                <div key={idx} className="border rounded-lg p-4">
                                    <h4 className="font-bold text-lg mb-3 text-blue-600">{practice.category}</h4>
                                    <ul className="space-y-2">
                                        {practice.items.map((item, i) => (
                                            <li key={i} className="flex items-start gap-2">
                                                <span className="text-green-500 mt-1">✓</span>
                                                <span className="text-gray-700">{item}</span>
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            const tabs = [
                { id: 'password', label: 'Password Analyzer' },
                { id: 'hash', label: 'Hash Generator' },
                { id: 'owasp', label: 'OWASP Top 10' },
                { id: 'practices', label: 'Best Practices' }
            ];

            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="bg-gradient-to-r from-red-600 to-pink-600 text-white shadow-lg">
                        <div className="container mx-auto px-4 py-6">
                            <div className="flex items-center justify-between">
                                <div>
                                    <h1 className="text-3xl font-bold">Security Tools</h1>
                                    <p className="text-sm opacity-90">by Balamurugan Sivaraman</p>
                                </div>
                                <a href="/" className="bg-white text-red-600 px-6 py-2 rounded-lg font-semibold hover:bg-gray-100 transition">
                                    ← Back to Home
                                </a>
                            </div>
                        </div>
                    </header>

                    <nav className="bg-white shadow-md sticky top-0 z-50">
                        <div className="container mx-auto px-4">
                            <div className="flex gap-2 overflow-x-auto py-2">
                                {tabs.map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`px-6 py-2 rounded-lg whitespace-nowrap font-medium transition ${
                                            activeTab === tab.id
                                                ? 'bg-red-600 text-white'
                                                : 'text-gray-600 hover:bg-gray-100'
                                        }`}
                                    >
                                        {tab.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </nav>

                    <main className="container mx-auto px-4 py-8">
                        {activeTab === 'password' && <PasswordAnalyzer />}
                        {activeTab === 'hash' && <HashGenerator />}
                        {activeTab === 'owasp' && <OWASPReference />}
                        {activeTab === 'practices' && <BestPractices />}
                    </main>

                    <footer className="bg-gray-800 text-white py-6 mt-12">
                        <div className="container mx-auto px-4 text-center">
                            <p>© 2024 Balamurugan Sivaraman - Security Tools</p>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('app'));
    </script>
</body>
</html>
