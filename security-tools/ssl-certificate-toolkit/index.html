<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL Certificate Toolkit Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/11.1.0/jsrsasign-all-min.js"></script>
    <link rel="stylesheet" href="./css/style.css">
</head>

<body>
    <div class="container">
        <header>
            <div>
                <h1>üîê SSL Certificate Toolkit Pro</h1>
                <p style="color: var(--text-secondary); margin-top: 5px;">100% Client-Side ‚Ä¢ No Server ‚Ä¢ Privacy-First
                </p>
            </div>
            <div class="header-controls">
                <button class="theme-toggle" onclick="toggleTheme()">üåì Toggle Theme</button>
                <button class="clear-session" onclick="clearSession()">üóëÔ∏è Clear Session</button>
                 <button class="back-home" onclick="goHome()">üè† Back to Home</button>
            </div>
        </header>

        <div class="privacy-notice">
            <strong>üîí Privacy Guarantee:</strong> All operations run entirely in your browser. No data is uploaded,
            stored, or transmitted.
            Files remain in memory only and are cleared when you close this page.
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab(0)">CSR Generation</button>
            <button class="tab" onclick="switchTab(1)">Self-Signed Cert</button>
            <button class="tab" onclick="switchTab(2)">Converters</button>
            <button class="tab" onclick="switchTab(3)">Verify & Analyze</button>
            <button class="tab" onclick="switchTab(4)">Advanced Tools</button>
            <button class="tab" onclick="switchTab(5)">Cheat Sheets</button>
        </div>

        <!-- TAB 1: CSR GENERATION -->
        <div class="tab-content active">
            <h2>üîë CSR Generation</h2>
            <div class="grid-2">
                <div>
                    <div class="form-group">
                        <label>Key Type</label>
                        <select id="csrKeyType">
                            <option value="RSA">RSA</option>
                            <option value="ECDSA">ECDSA (P-256)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Key Size (RSA only)</label>
                        <select id="csrKeySize">
                            <option value="2048">2048 bits</option>
                            <option value="4096">4096 bits</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Common Name (CN) *</label>
                        <input type="text" id="csrCN" placeholder="example.com">
                    </div>
                    <div class="form-group">
                        <label>Organization (O)</label>
                        <input type="text" id="csrO" placeholder="My Company Inc">
                    </div>
                    <div class="form-group">
                        <label>Organizational Unit (OU)</label>
                        <input type="text" id="csrOU" placeholder="IT Department">
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label>Locality (L)</label>
                        <input type="text" id="csrL" placeholder="San Francisco">
                    </div>
                    <div class="form-group">
                        <label>State/Province (ST)</label>
                        <input type="text" id="csrST" placeholder="California">
                    </div>
                    <div class="form-group">
                        <label>Country (C)</label>
                        <input type="text" id="csrC" placeholder="US" maxlength="2">
                    </div>
                    <div class="form-group">
                        <label>Subject Alternative Names (SAN) - comma separated</label>
                        <input type="text" id="csrSAN" placeholder="www.example.com, api.example.com">
                    </div>
                    <div class="form-group">
                    <label>Output Format</label>
                    <select id="csrFormat">
                        <option value="PEM">PEM (.pem, .csr)</option>
                        <option value="DER">DER (.der)</option>
                        <option value="PKCS10">PKCS#10 Base64</option>
                        <option value="TEXT">Text Format (Readable)</option>
                    </select>
                </div>
                </div>
            </div>
            <button class="btn btn-success" onclick="generateCSR()">üî® Generate CSR & Private Key</button>
            <div id="csrOutput"></div>
        </div>

        <!-- TAB 2: SELF-SIGNED CERTIFICATE -->
        <div class="tab-content">
            <h2>üìú Self-Signed Certificate Generator</h2>
            <div class="grid-2">
                <div>
                    <div class="form-group">
                        <label>Key Type</label>
                        <select id="selfKeyType">
                            <option value="RSA">RSA</option>
                            <option value="ECDSA">ECDSA (P-256)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Key Size (RSA only)</label>
                        <select id="selfKeySize">
                            <option value="2048">2048 bits</option>
                            <option value="4096">4096 bits</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Common Name (CN) *</label>
                        <input type="text" id="selfCN" placeholder="localhost">
                    </div>
                    <div class="form-group">
                        <label>Organization (O)</label>
                        <input type="text" id="selfO" placeholder="My Company">
                    </div>
                    <div class="form-group">
                        <label>Validity (days)</label>
                        <input type="number" id="selfValidity" value="365" min="1">
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label>Locality (L)</label>
                        <input type="text" id="selfL" placeholder="City">
                    </div>
                    <div class="form-group">
                        <label>State/Province (ST)</label>
                        <input type="text" id="selfST" placeholder="State">
                    </div>
                    <div class="form-group">
                        <label>Country (C)</label>
                        <input type="text" id="selfC" placeholder="US" maxlength="2">
                    </div>
                    <div class="form-group">
                        <label>Subject Alternative Names (SAN)</label>
                        <input type="text" id="selfSAN" placeholder="localhost, 127.0.0.1">
                    </div>
                    <div class="form-group">
                        <label>Output Format</label>
                        <select id="selfFormat">
                            <option value="PEM">PEM</option>
                            <option value="DER">DER</option>
                        </select>
                    </div>
                </div>
            </div>
            <button class="btn btn-success" onclick="generateSelfSigned()">üî® Generate Self-Signed Certificate</button>
            <div id="selfSignedOutput"></div>
        </div>

        <!-- TAB 3: CONVERTERS -->
        <div class="tab-content">
            <h2>üîÑ Certificate & Key Converters</h2>
            <div class="form-group">
                <label>Select Conversion Type</label>
                <select id="conversionType" onchange="updateConverterUI()">
                    <option value="pem2der">PEM to DER</option>
                    <option value="der2pem">DER to PEM</option>
                    <option value="pem2pkcs7">PEM to PKCS#7</option>
                    <option value="pkcs72pem">PKCS#7 to PEM</option>
                    <option value="pem2pfx">PEM to PFX (PKCS#12)</option>
                    <option value="pfx2pem">PFX to PEM</option>
                    <option value="csr2pem">CSR to PEM</option>
                    <option value="csr2der">CSR to DER</option>
                </select>
            </div>
            
            <div id="pfxInputSection" style="display: none;">
                <div class="form-group">
                    <label>Certificate File (PEM)</label>
                    <input type="file" id="pfxCertFile" accept=".pem,.crt,.cer">
                </div>
                    <!-- Manual Paste Canvas -->
                <!-- Converter Manual Input Canvas -->
                    <div id="converterManualInput" class="form-group" style="display:none;">
                        <label>üìù Paste Certificate / Key / Chain (PEM / PKCS#7)</label>

                        <textarea
                            id="converterTextInput"
                            placeholder="-----BEGIN CERTIFICATE-----
                    Paste certificate, key, CSR, or PKCS#7 content here...
                    -----END CERTIFICATE-----"
                            style="min-height: 200px; font-family: 'Courier New', monospace;">
                        </textarea>

                        <button class="btn" onclick="convertFromText()">üîÑ Convert Text</button>

                        <div style="text-align:center; margin: 15px 0; color: var(--text-secondary);">
                            <strong>OR</strong>
                        </div>
                    </div>

                <div class="form-group">
                    <label>Private Key File (PEM)</label>
                    <input type="file" id="pfxKeyFile" accept=".pem,.key">
                </div>
                <div class="form-group">
                    <label>PFX Password *</label>
                    <input type="password" id="pfxPassword" placeholder="Enter password for PFX">
                </div>
                <div class="form-group">
                    <label>Friendly Name (Optional)</label>
                    <input type="text" id="pfxFriendlyName" placeholder="My Certificate">
                </div>
            </div>
            
            <div id="pfxExtractSection" style="display: none;">
                <div class="form-group">
                    <label>PFX Password</label>
                    <input type="password" id="pfxExtractPassword" placeholder="Enter PFX password">
                </div>
            </div>
            
            <div class="file-drop" id="converterFileDrop" onclick="document.getElementById('converterFile').click()">
                üìÅ Click or drag files here to upload
                <input type="file" id="converterFile" style="display: none;" multiple>
            </div>
            
            <button class="btn btn-success" onclick="performConversion()">üîÑ Convert</button>
            <div id="converterOutput"></div>
        </div>

        <!-- TAB 4: VERIFY & ANALYZE -->
        <div class="tab-content">
            <h2>üîç Verify, Extract & Analyze</h2>
            <div class="form-group">
                <label>Select Analysis Tool</label>
                <select id="analysisType" onchange="updateAnalysisUI()">
                    <option value="decode-cert">Certificate Decoder</option>
                    <option value="decode-csr">CSR Decoder</option>
                    <option value="match-key">Key ‚Üî Certificate Matching</option>
                    <option value="lint">Certificate Linter</option>
                    <option value="expiry">Expiry Calculator</option>
                    <option value="extract-all">Extract Certificate/Key/Chain</option>
                </select>
            </div>
    
    <!-- Text Input Canvas -->
    <div class="form-group">
        <label>üìù Paste Certificate/CSR/Key Content (PEM format)</label>
        <textarea id="certTextInput" placeholder="-----BEGIN CERTIFICATE-----
Paste your certificate, CSR, or key content here...
-----END CERTIFICATE-----" style="min-height: 200px; font-family: 'Courier New', monospace;"></textarea>
        <button class="btn" onclick="analyzeFromText()">üîç Analyze Text</button>
    </div>
    
    <div style="text-align: center; margin: 20px 0; color: var(--text-secondary);">
        <strong>OR</strong>
    </div>
    
    <div class="file-drop" onclick="document.getElementById('analysisFile').click()">
        üìÅ Click or drag certificate/key files here
        <input type="file" id="analysisFile" style="display: none;" multiple>
    </div>
    <button class="btn btn-success" onclick="performAnalysis()">üîç Analyze</button>
    <div id="analysisOutput"></div>
</div>

        <!-- TAB 5: ADVANCED TOOLS -->
        <div class="tab-content">
            <h2>üõ†Ô∏è Advanced Tools</h2>
            <div class="form-group">
                <label>Select Tool</label>
                <select id="advancedToolType" onchange="updateAdvancedToolUI()">
                    <option value="compare">Certificate Comparison Tool</option>
                    <option value="bulk-audit">Bulk Certificate Audit</option>
                    <option value="chain-builder">Certificate Chain Builder</option>
                    <option value="hash-calc">Hash Calculator & Fingerprint</option>
                    <option value="cmd-builder">OpenSSL Command Builder</option>
                    <option value="bundle-creator">Certificate Bundle Creator</option>
                    <option value="visualize">Certificate Visualization</option>
                </select>
            </div>
            <div id="advancedToolContainer"></div>
        </div>

        <!-- TAB 6: CHEAT SHEETS -->
        <div class="tab-content">
            <h2>üìö Cheat Sheets & References</h2>

            <div class="cheatsheet">
                <h3>üîß OpenSSL Common Commands</h3>
                <pre><code># Generate RSA Private Key (2048-bit)
openssl genrsa -out private.key 2048

# Generate RSA Private Key (4096-bit)
openssl genrsa -out private.key 4096

# Generate ECDSA Private Key (P-256)
openssl ecparam -genkey -name prime256v1 -out private.key

# Create CSR from existing key
openssl req -new -key private.key -out request.csr

# Generate Self-Signed Certificate
openssl req -x509 -new -nodes -key private.key -sha256 -days 365 -out certificate.crt

# View Certificate Details
openssl x509 -in certificate.crt -text -noout

# View CSR Details
openssl req -in request.csr -text -noout

# Convert PEM to DER
openssl x509 -in cert.pem -outform DER -out cert.der

# Convert DER to PEM
openssl x509 -in cert.der -inform DER -out cert.pem

# Verify Certificate and Key Match
openssl x509 -noout -modulus -in certificate.crt | openssl md5
openssl rsa -noout -modulus -in private.key | openssl md5</code></pre>
            </div>

            <div class="cheatsheet">
                <h3>‚ö° PowerShell PKI Commands</h3>
                <pre><code># Generate Self-Signed Certificate
$cert = New-SelfSignedCertificate -DnsName "example.com" -CertStoreLocation "Cert:\CurrentUser\My"

# Export Certificate to PFX
$pwd = ConvertTo-SecureString -String "password" -Force -AsPlainText
Export-PfxCertificate -Cert $cert -FilePath "certificate.pfx" -Password $pwd

# Import PFX
Import-PfxCertificate -FilePath "certificate.pfx" -CertStoreLocation "Cert:\CurrentUser\My" -Password $pwd

# List Certificates
Get-ChildItem -Path Cert:\CurrentUser\My

# View Certificate Details
Get-ChildItem -Path Cert:\CurrentUser\My | Where-Object {$_.Subject -match "example.com"} | Format-List *</code></pre>
            </div>

            <div class="cheatsheet">
                <h3>üìù OpenSSL Configuration File (openssl.cnf)</h3>
                <pre><code># Basic CSR Configuration Template
[ req ]
default_bits        = 2048
prompt              = no
default_md          = sha256
distinguished_name  = req_dn
req_extensions      = req_ext

[ req_dn ]
C                   = US
ST                  = California
L                   = San Francisco
O                   = Example Company Inc
OU                  = IT Department
CN                  = example.com

[ req_ext ]
subjectAltName      = @alt_names
keyUsage            = digitalSignature, keyEncipherment
extendedKeyUsage    = serverAuth, clientAuth

[alt_names]
DNS.1 = example.com
DNS.2 = www.example.com
DNS.3 = api.example.com
IP.1 = 10.10.10.10
IP.2 = ::1

# Usage:
# openssl req -new -key private.key -out request.csr -config openssl.cnf</code></pre>
            </div>

            <div class="cheatsheet">
                <h3>üìÑ Certificate Format Differences</h3>
                <div class="grid-2">
                    <div class="info-card">
                        <h3>PEM (Privacy Enhanced Mail)</h3>
                        <ul>
                            <li><strong>Encoding:</strong> Base64</li>
                            <li><strong>Extension:</strong> .pem, .crt, .cer, .key</li>
                            <li><strong>Format:</strong> Text-based</li>
                            <li><strong>Use Case:</strong> Most common, human-readable</li>
                            <li><strong>Platform:</strong> Linux, Apache, NGINX</li>
                        </ul>
                    </div>
                    <div class="info-card">
                        <h3>DER (Distinguished Encoding Rules)</h3>
                        <ul>
                            <li><strong>Encoding:</strong> Binary</li>
                            <li><strong>Extension:</strong> .der, .cer</li>
                            <li><strong>Format:</strong> Binary ASN.1</li>
                            <li><strong>Use Case:</strong> Java applications</li>
                            <li><strong>Platform:</strong> Windows, Java</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="cheatsheet">
                <h3>üõ°Ô∏è Security Best Practices</h3>
                <div class="info-card">
                    <ul>
                        <li><strong>Key Size:</strong> Use minimum 2048-bit RSA or ECDSA P-256</li>
                        <li><strong>Algorithm:</strong> Avoid MD5 and SHA-1; use SHA-256 or better</li>
                        <li><strong>Validity:</strong> Maximum 398 days for public certificates</li>
                        <li><strong>SAN:</strong> Always include CN in SAN field</li>
                        <li><strong>Private Keys:</strong> Never share unencrypted private keys</li>
                        <li><strong>Renewal:</strong> Renew certificates 30 days before expiry</li>
                    </ul>
                </div>
            </div>

            <div class="cheatsheet">
                <h3>üìã Configuration File Generator</h3>
                <button class="btn btn-success" onclick="showConfigGenerator()">üî® Generate Custom OpenSSL
                    Config</button>
                <div id="configGeneratorOutput"></div>
            </div>
        </div>

        <footer>
            <p>üîê SSL Certificate Toolkit Pro v1.0 | 100% Client-Side | No Data Collection</p>
            <p style="margin-top: 10px; font-size: 0.85rem;">All cryptographic operations performed locally in your
                browser</p>
        </footer>
    </div>

    <!-- Load Scripts in Order -->
    <script src="./js/core.js"></script>
    <script src="./js/helpers.js"></script>
    <script src="./js/ui.js"></script>
    <script src="./js/csr.js"></script>
    <script src="./js/selfsigned.js"></script>
    <script src="./js/converters.js"></script>
    <script src="./js/analysis.js"></script>
    <script src="./js/compare.js"></script>
    <script src="./js/bulk-audit.js"></script>
    <script src="./js/chain.js"></script>
    <script src="./js/hash.js"></script>
    <script src="./js/cmd-builder.js"></script>
    <script src="./js/bundle.js"></script>
    <script src="./js/visualize.js"></script>
    <script src="./js/config-generator.js"></script>
    <script src="./js/advanced-tools.js"></script>
    <script src="./js/script.js"></script>
</body>


</html>

